<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Introducing CVE Markdown Charts - Part 1" /><meta property="og:locale" content="en" /><meta name="description" content="CVE Markdown Charts - Your InfoSec reports will now write themselves. After writing several Infosec reports and researching popular CVEs, I discovered a means to create dynamic charts that help readers and myself understand various CVE relationships and their implications." /><meta property="og:description" content="CVE Markdown Charts - Your InfoSec reports will now write themselves. After writing several Infosec reports and researching popular CVEs, I discovered a means to create dynamic charts that help readers and myself understand various CVE relationships and their implications." /><link rel="canonical" href="https://clearbluejar.github.io/posts/introducing-cve-markdown-charts-part-1/" /><meta property="og:url" content="https://clearbluejar.github.io/posts/introducing-cve-markdown-charts-part-1/" /><meta property="og:site_name" content="clearbluejar" /><meta property="og:image" content="https://clearbluejar.github.io/assets/img/2022-03-19-introducing-cve-markdown-charts-part-1/pexels-rodnae-productions-7947663.jpg" /><meta property="og:image:alt" content="CVE Charts - Photo by RODNAE Productions from Pexels" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-03-19T21:56:43+00:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://clearbluejar.github.io/assets/img/2022-03-19-introducing-cve-markdown-charts-part-1/pexels-rodnae-productions-7947663.jpg" /><meta name="twitter:image:alt" content="CVE Charts - Photo by RODNAE Productions from Pexels" /><meta property="twitter:title" content="Introducing CVE Markdown Charts - Part 1" /><meta name="twitter:site" content="@clearbluejar" /><meta name="google-site-verification" content="yeZcjox5p1UhtqcHFYkiXFGf013zyULTn74IVNLoVbE" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-06-24T12:24:21+00:00","datePublished":"2022-03-19T21:56:43+00:00","description":"CVE Markdown Charts - Your InfoSec reports will now write themselves. After writing several Infosec reports and researching popular CVEs, I discovered a means to create dynamic charts that help readers and myself understand various CVE relationships and their implications.","headline":"Introducing CVE Markdown Charts - Part 1","image":{"src":"/assets/img/2022-03-19-introducing-cve-markdown-charts-part-1/pexels-rodnae-productions-7947663.jpg","alt":"CVE Charts - Photo by RODNAE Productions from Pexels","url":"https://clearbluejar.github.io/assets/img/2022-03-19-introducing-cve-markdown-charts-part-1/pexels-rodnae-productions-7947663.jpg","@type":"imageObject"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://clearbluejar.github.io/posts/introducing-cve-markdown-charts-part-1/"},"url":"https://clearbluejar.github.io/posts/introducing-cve-markdown-charts-part-1/"}</script><title>Introducing CVE Markdown Charts - Part 1 | clearbluejar</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="clearbluejar"><meta name="application-name" content="clearbluejar"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="https://github.com/clearbluejar.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">clearbluejar</a></div><div class="site-subtitle font-italic">blog, code, and research</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/clearbluejar" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/clearbluejar" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Introducing CVE Markdown Charts - Part 1</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>Introducing CVE Markdown Charts - Part 1</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1647727003" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Mar 19, 2022 </em> </span> <span> Updated <em class="" data-ts="1656073461" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Jun 24, 2022 </em> </span><div class="mt-3 mb-3"> <img data-src="/assets/img/2022-03-19-introducing-cve-markdown-charts-part-1/pexels-rodnae-productions-7947663.jpg" class="preview-img bg" alt="CVE Charts - Photo by RODNAE Productions from Pexels" data-proofer-ignore><figcaption class="pt-2 pb-2">CVE Charts - Photo by RODNAE Productions from Pexels</figcaption></div><div class="d-flex justify-content-between"> <span> By <em> <a href="https://twitter.com/clearbluejar">clearbluejar</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="3318 words"> <em>18 min</em> read</span></div></div></div><div class="post-content"><blockquote><p>TL;DR - CVE Markdown Charts - Your InfoSec reports will now write themselves… After writing several InfoSec reports and researching CVEs, I discovered a means to create dynamic charts that help readers and myself understand various CVE relationships and their implications.</p></blockquote><p>Say hello to <a href="https://github.com/clearbluejar/cve-markdown-charts">CVE Markdown Charts</a>, or at least its first iteration (<a href="https://github.com/clearbluejar/cve-markdown-charts/tree/v0.1.0">v0.1.0</a>). CVE, as in <a href="https://en.wikipedia.org/wiki/Common_Vulnerabilities_and_Exposures">Common Vulnerabilities and Exposures</a>, where a CVE ID (something in the form of CVE-2022-1234) references a specific instance of a known vulnerability in software. <a href="https://en.wikipedia.org/wiki/Markdown">Markdown</a>, as in the popular writing markup language used everywhere by bloggers and developers alike. Charts, as in well, charts, but generated with <a href="https://mermaid-js.github.io/mermaid/#/">Mermaid.js</a>.</p><p>This post is the first part of what will probably become a short series of posts sharing lessons learned during the development of CVE Markdown Charts. This first one is about that 80% solution. And the sequel, coming later, will describe that last 20% that will take me 3x as long to complete.</p><p>We begin with the reason for the project, and the steps taken to solve the issue, and show an initial proof of concept.</p><h2 id="the-issue"><span class="mr-2">The Issue</span><a href="#the-issue" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Typically, when I study a new software component as related to security, or perhaps for InfoSec writing or research, I start by reviewing the CVEs for said component to get a basic understanding of the security issues and common bugs for the software. To find related CVEs, I <a href="https://cve.mitre.org/cve/search_cve_list.html">search</a> for them on <a href="https://cve.mitre.org">cve.mitre.org</a> using a keyword like “Windows Print Spooler” or “Google Chrome Use After Free”. The results from the search will come back in a table with matches from the <a href="https://cve.mitre.org/cve/identifiers/#:~:text=includes%20the%20following%3A-,CVE%20ID,-number%20with%20four">CVE ID</a> directly or from keywords in the CVE description.</p><p><img data-src="/assets/img/2022-03-19-introducing-cve-markdown-charts-part-1/cve-search-result-spooler.png" alt="spooler cve results" class="shadow" data-proofer-ignore><em>Windows Print Spooler Search Results -cve.mitre.org</em></p><h3 id="msrc-api"><span class="mr-2">MSRC API</span><a href="#msrc-api" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Besides Mitre, I have also been using the Microsoft Security Response Center (<a href="https://msrc.microsoft.com/">MSRC</a>) security updates when researching Windows CVEs. Each security update, formatted in the Common Vulnerability Reporting Framework (<a href="https://www.icasi.org/cvrf/">CVRF</a>) JSON format, contains details about the latest CVEs (release date, links to patches, products affected, etc.). The monthly updates each have a unique <em>CVRF ID</em> like <code class="language-plaintext highlighter-rouge">2021-Dec</code>. MSRC makes the updates available via their <a href="https://api.msrc.microsoft.com/cvrf/v2.0/swagger/index">MSRC API</a>, which you can test out using their <a href="https://swagger.io/">swagger</a> front end. I had been using their API to download the relevant security update JSON pulling out detailed information for any Microsoft CVEs. One of the MSRC REST endpoints provides a convenient CVE ID -&gt; CVRF ID map.</p><h4 id="updates-endpoint"><span class="mr-2">Updates Endpoint</span><a href="#updates-endpoint" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>A query for <em>CVE-2020-1048</em>:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>% curl <span class="nt">-X</span> GET <span class="nt">--header</span> <span class="s1">'Accept: application/json'</span> <span class="s2">"https://api.msrc.microsoft.com/cvrf/v2.0/Updates('CVE-2020-1048')"</span>
</pre></table></code></div></div><p>The response:</p><div class="language-json highlighter-rouge"><div class="code-header"> <span data-label-text="JSON"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="p">{</span><span class="w">
    </span><span class="nl">"@odata.context"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://msrc-cvrf.azurewebsites.net/odata/$metadata#Updates"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"value"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"ID"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-May"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"Alias"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-May"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"DocumentTitle"</span><span class="p">:</span><span class="w"> </span><span class="s2">"May 2020 Security Updates"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"Severity"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="nl">"InitialReleaseDate"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-05-12T07:00:00Z"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"CurrentReleaseDate"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2021-02-25T08:00:00Z"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"CvrfUrl"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://api.msrc.microsoft.com/cvrf/v2.0/document/2020-May"</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></table></code></div></div><p>From the <em>CVRF ID</em> <code class="language-plaintext highlighter-rouge">2020-May</code> the MSRC API provides corresponding security update CVRF JSON.</p><h4 id="cvrf-endpoint"><span class="mr-2">CVRF Endpoint</span><a href="#cvrf-endpoint" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>% curl <span class="nt">-X</span> GET <span class="nt">--header</span> <span class="s1">'Accept: application/json'</span> <span class="s1">'https://api.msrc.microsoft.com/cvrf/v2.0/cvrf/2020-May'</span>
</pre></table></code></div></div><p>The monthly security update will have detailed information about the products affected and a list of all the CVEs.</p><div class="language-json highlighter-rouge"><div class="code-header"> <span data-label-text="JSON"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre><span class="p">{</span><span class="w">
    </span><span class="nl">"DocumentTitle"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"Value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"May 2020 Security Updates"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"DocumentType"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"Value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Security Update"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"DocumentPublisher"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"ContactDetails"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"Value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"secure@microsoft.com"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="nl">"IssuingAuthority"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"Value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"The Microsoft Security Response Center (MSRC) identifies, monitors, resolves, and responds to security incidents and Microsoft software security vulnerabilities. For more information, see http://www.microsoft.com/security/msrc."</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="nl">"Type"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"DocumentTracking"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"Identification"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"ID"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nl">"Value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-May"</span><span class="w">
        </span><span class="p">},</span><span class="w">

</span><span class="err">/*</span><span class="w"> </span><span class="err">several</span><span class="w"> </span><span class="err">lines</span><span class="w"> </span><span class="err">omitted</span><span class="w"> </span><span class="err">*/</span><span class="w">
</span></pre></table></code></div></div><p>Within contains more detail about each CVE:</p><div class="language-json highlighter-rouge"><div class="code-header"> <span data-label-text="JSON"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
</pre><td class="rouge-code"><pre><span class="p">{</span><span class="w">
      </span><span class="nl">"Title"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"Value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Windows Print Spooler Elevation of Privilege Vulnerability"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="nl">"Notes"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="nl">"Title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Description"</span><span class="p">,</span><span class="w">
          </span><span class="nl">"Type"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
          </span><span class="nl">"Ordinal"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0"</span><span class="p">,</span><span class="w">
          </span><span class="nl">"Value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;p&gt;An elevation of privilege vulnerability exists when the Windows Print Spooler service improperly allows arbitrary writing to the file system. An attacker who ....&lt;/p&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="nl">"Title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Microsoft Windows"</span><span class="p">,</span><span class="w">
          </span><span class="nl">"Type"</span><span class="p">:</span><span class="w"> </span><span class="mi">7</span><span class="p">,</span><span class="w">
          </span><span class="nl">"Ordinal"</span><span class="p">:</span><span class="w"> </span><span class="s2">"20"</span><span class="p">,</span><span class="w">
          </span><span class="nl">"Value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Microsoft Windows"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="nl">"Title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Issuing CNA"</span><span class="p">,</span><span class="w">
          </span><span class="nl">"Type"</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w">
          </span><span class="nl">"Ordinal"</span><span class="p">:</span><span class="w"> </span><span class="s2">"30"</span><span class="p">,</span><span class="w">
          </span><span class="nl">"Value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Microsoft"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">],</span><span class="w">
      </span><span class="nl">"DiscoveryDateSpecified"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
      </span><span class="nl">"ReleaseDateSpecified"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
      </span><span class="nl">"CVE"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CVE-2020-1048"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"ProductStatuses"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="nl">"ProductID"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
            </span><span class="s2">"11497"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"11498"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"11499"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"11563"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"11568"</span><span class="p">,</span><span class="w">
</span></pre></table></code></div></div><p>Including details about the Microsoft <a href="https://en.wikipedia.org/wiki/Microsoft_Knowledge_Base">Knowledge Base</a> Articles, links to binary patch updates, and other useful fields are available for each CVE:</p><div class="language-json highlighter-rouge"><div class="code-header"> <span data-label-text="JSON"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre><td class="rouge-code"><pre><span class="nl">"Remediations"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="nl">"Description"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"Value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4556807"</span><span class="w">
          </span><span class="p">},</span><span class="w">
          </span><span class="nl">"URL"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://catalog.update.microsoft.com/v7/site/Search.aspx?q=KB4556807"</span><span class="p">,</span><span class="w">
          </span><span class="nl">"Supercedence"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4550922"</span><span class="p">,</span><span class="w">
          </span><span class="nl">"ProductID"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
            </span><span class="s2">"11497"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"11498"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"11499"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"11563"</span><span class="w">
          </span><span class="p">],</span><span class="w">
          </span><span class="nl">"Type"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
          </span><span class="nl">"DateSpecified"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
          </span><span class="nl">"AffectedFiles"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
          </span><span class="nl">"RestartRequired"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"Value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Yes"</span><span class="w">
          </span><span class="p">},</span><span class="w">
          </span><span class="nl">"SubType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Security Update"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="nl">"Description"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"Value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4551853"</span><span class="w">
          </span><span class="p">},</span><span class="w">
          </span><span class="nl">"URL"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://catalog.update.microsoft.com/v7/site/Search.aspx?q=KB4551853"</span><span class="p">,</span><span class="w">
          </span><span class="nl">"Supercedence"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4549949"</span><span class="p">,</span><span class="w">
</span></pre></table></code></div></div><p>I was leveraging information from these two sources when attempting to explain CVEs and their relationships. I dug through the sites and JSON data to construct tables and graphs to explain CVE release timelines and frequency. While studying CVEs for popular topics (like the “Windows Print Spooler” and its explosion of CVEs over the past two years), watching <a href="https://www.youtube.com/watch?v=CHWSewPDfhs">presentations</a>, reading <a href="https://i.blackhat.com/USA21/Wednesday-Handouts/us-21-Diving-Into-Spooler-Discovering-Lpe-And-Rce-Vulnerabilities-In-Windows-Printer.pdf">slides</a> and <a href="https://github.com/cube0x0/CVE-2021-1675">code</a>, it was hard to keep track of it all. I found myself taking notes, creating list and tables, trying to keep track of each CVE (when they came out, the type of bug, and who found them).</p><h3 id="markdown-and-mermaidjs"><span class="mr-2">Markdown and Mermaid.js</span><a href="#markdown-and-mermaidjs" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>I write my notes (and most everything) in <a href="https://en.wikipedia.org/wiki/Markdown">Markdown</a>, along with what seems to be most of the rest of the world. While using Markdown, I discovered <a href="https://mermaid-js.github.io/mermaid/#/">Mermaids.js</a> for charts and graphs and haven’t looked back.</p><p><img data-src="/assets/img/2022-03-19-introducing-cve-markdown-charts-part-1/mermaid-js-cover.png" alt="mermaid" class="shadow" data-proofer-ignore><em>Mermaid.js</em></p><p>The ability dynamically to create charts and graphs from basic plaintext is powerful. Also, Mermaid.js is Javascript. All you need to <a href="https://mermaid-js.github.io/mermaid/#/usage?id=using-mermaid">include</a> it in your website or application is this script tag:</p><div class="language-js highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">script</span> <span class="nx">src</span><span class="o">=</span><span class="dl">"</span><span class="s2">https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js</span><span class="dl">"</span><span class="o">&gt;&lt;</span><span class="sr">/script</span><span class="err">&gt;
</span></pre></table></code></div></div><p>That also means that most popular <a href="https://en-gb.wordpress.org/plugins/wp-mermaid/">blogging</a> and <a href="https://marketplace.visualstudio.com/items?itemName=vstirbu.vscode-mermaid-preview">code</a> applications support it and you can create all the README graphs you want in <a href="https://docs.gitlab.com/ee/user/markdown.html#mermaid">Gitlab</a> or <a href="https://github.blog/2022-02-14-include-diagrams-markdown-files-mermaid/">Github</a>.</p><p>For CVEs, when trying to represent a timeline of patch releases, I painstakingly created the following <em>Mermaids.js</em> <a href="https://mermaid-js.github.io/mermaid/#/gantt">Gantt chart</a>.</p><div class="language-markdown highlighter-rouge"><div class="code-header"> <span data-label-text="Markdown"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre><td class="rouge-code"><pre><span class="p">```</span><span class="nl">mermaid
</span><span class="sb">gantt

title Windows Print Spooler (6.1.7601) Monthly Patches and CVEs
dateFormat  YYYY-MM-DD
axisFormat %Y-%m

section Monthly Cumulative Patches
KB4550964 :m1, 2020-04-14, 2020-05-11 
KB4556836 :m2, 2020-05-12, 2020-06-08
KB4561643 :m3, 2020-06-09, 2020-07-13
KB4565524 :m4, 2020-07-14, 2020-08-10
KB4571729 :m5, 2020-08-11, 2020-09-07
KB4577051 :m6, 2020-09-08, 2020-10-12
KB4580345 :m7, 2020-10-13, 2020-11-09
KB4586827 :m8, 2020-11-10, 2020-12-07
KB4592471 :m9, 2020-12-08, 2021-01-11
KB4598279 :m10, 2021-01-12, 2021-02-08
  
section Relevant CVEs

CVE-2020-1048 :a2, 2020-05-12, 2020-06-08
CVE-2020-1337 :a3, 2020-08-11, 2020-09-07
CVE-2020-17001 :a4, 2020-11-10, 2020-12-07

</span></pre></table></code></div></div><p>It was worth it because <em>Mermiad.js</em> transformed the plaintext into this:</p><pre><code class="language-mermaid">gantt

title Windows Print Spooler (6.1.7601) Monthly Patches and CVEs 
dateFormat  YYYY-MM-DD
axisFormat %Y-%m

section Monthly Cumulative Patches
KB4550964 :m1, 2020-04-14, 2020-05-11 
KB4556836 :m2, 2020-05-12, 2020-06-08
KB4561643 :m3, 2020-06-09, 2020-07-13
KB4565524 :m4, 2020-07-14, 2020-08-10
KB4571729 :m5, 2020-08-11, 2020-09-07
KB4577051 :m6, 2020-09-08, 2020-10-12
KB4580345 :m7, 2020-10-13, 2020-11-09
KB4586827 :m8, 2020-11-10, 2020-12-07
KB4592471 :m9, 2020-12-08, 2021-01-11
KB4598279 :m10, 2021-01-12, 2021-02-08
  
section Relevant CVEs

CVE-2020-1048 :a2, 2020-05-12, 2020-06-08
CVE-2020-1337 :a3, 2020-08-11, 2020-09-07
CVE-2020-17001 :a4, 2020-11-10, 2020-12-07

</code></pre><p>Looks pretty good. You can copy and paste the plaintext anywhere and reuse that information, or tweak it without having to deal with generating or storing images. That being the case, after manually creating tables and <a href="https://mermaid-js.github.io/mermaid/#/flowchart">charts</a> for my CVE research about 10x, it was getting a bit tedious. Having to click through all the Mitre links and dig around in MSRC CVRF JSON became too much. The thought of having to create yet another CVE chart was the motivation I needed to do what every developer does when they discover a tedious, repeatable process, <strong>write a script.</strong> :)</p><h2 id="the-idea"><span class="mr-2">The Idea</span><a href="#the-idea" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>OK, the problem is that I have future reports to write that will include various CVE charts, and I want to save time and effort. I began with some common use cases.</p><ul><li><a href="https://mermaid-js.github.io/mermaid/#/gantt">Gantt Chart</a><ul><li>CVEs on a specific software component over time - Think of it like CVE version of <a href="https://trends.google.com/trends/">Google Trends</a><li>CVEs of a particular vulnerability class (or CWE) for a particular software over time - This can can hint at which types of bugs you are likely to find.</ul><li><a href="https://github.com/adam-p/markdown-here/wiki/Markdown-Cheatsheet#tables">Markdown table</a><ul><li>Table of all the software component CVEs and their corresponding binary update download links - For Notes.<li>Table of CVEs by researcher (see Acknowledgements) for a particular topic - This can help find other related research or posts by the researchers.</ul></ul><p>Although there are several more use cases I can think of, this first post will walk through the Gantt Chart and Markdown table generation.</p><h3 id="visual"><span class="mr-2">Visual</span><a href="#visual" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>OK, let’s generate some charts. Let me first show my thoughts with a nice Mermaid.js <a href="https://mermaid-js.github.io/mermaid/#/flowchart">flowchart</a>.</p><pre><code class="language-mermaid">
flowchart LR;

a[(Mitre CVEs)] &lt;--&gt; script;
c[(Microsoft CVRFs)] &lt;--&gt; script;
c1[(Other CVE Sources?)] &lt;--&gt; script;
e[CVE search term] --&gt; script;

script --&gt; f[amazing CVE markdown chart]

subgraph script
    d[magic logic]
end

</code></pre><h2 id="development"><span class="mr-2">Development</span><a href="#development" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Before I started down my path of solving all my problems, I needed to find out if someone else already had. Checking to see what else is out there will help prevent you from reinventing the wheel, or at least provide inspiration and perhaps some lessons learned from other projects.</p><h3 id="what-wheels-already-exists"><span class="mr-2">What Wheels Already Exists?</span><a href="#what-wheels-already-exists" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>A quick Github search came up with:</p><div class="table-wrapper"><table><thead><tr><th>Tool<th>Language<tbody><tr><td><a href="https://github.com/NopSec/ThreatIntelScripts/blob/master/find_microsoft_kb_by_cve.py">find_microsoft_kb_by_cve.py</a><td>Python<tr><td><a href="https://github.com/Microsoft/MSRC-Microsoft-Security-Updates-API/blob/main/src/README.md">MSRCSecurityUpdates</a><td>Powershell</table></div><p>The Python script <a href="https://github.com/NopSec/ThreatIntelScripts/blob/ab3cb43368bca131c4d700711349cfe1ce00372b/find_microsoft_kb_by_cve.py"><code class="language-plaintext highlighter-rouge">find_microsoft_kb_by_cve.py</code></a> was a concise script that would take a CVE as input and dump a list of Knowledge Base IDs (like <code class="language-plaintext highlighter-rouge">KB5010359</code>) related to the CVE. Something like CVE -&gt; CVRF ID -&gt; List of KB links. This could actually serve as a solid starting point, providing the CVRF security update JSON for a CVE. And I could parse out what I needed from the corresponding CVRF JSON.</p><p>The Powershell code had some examples of using the CVRF security update with a template to <a href="https://github.com/microsoft/MSRC-Microsoft-Security-Updates-API/blob/main/src/MsrcSecurityUpdates/Public/Get-MsrcSecurityBulletinHtml.ps1">generate a HTML page</a> leveraging the provided JSON. This is similar to what I need to do to generate a Mermaid.js Markdown graph or chart. They had a <a href="https://github.com/microsoft/MSRC-Microsoft-Security-Updates-API/blob/f7ede22d2a05fbaa0edcbb4ca0ad39798ac88805/src/MsrcSecurityUpdates/Public/Get-MsrcSecurityBulletinHtml.ps1#L51">HTML template</a> that the script populated with elements from their CVRF security update JSON.</p><p>In a short amount of time, remembering that I am pretty green in Powershell scripting, I went with Python.</p><h3 id="requirements"><span class="mr-2">Requirements</span><a href="#requirements" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>OK, using <code class="language-plaintext highlighter-rouge">find_microsoft_kb_by_cve.py</code> as inspiration, I started on my journey. Starting with the two use cases above, I set out to build a Markdown table () and a Mermaid.js Gannt chart. Basically, the script receives a CVE keyword and spits out a Mermaid.js compatible chart (or rather its plaintext).</p><p>To support that, we need the following capabilities:</p><ul><li><a href="#getting-a-list-of-cves---beautiful-soup">Build CVE list from Keyword</a> - The ability to query Mitre CVE by keyword to obtain a list of matching CVEs<li><a href="#getting-a-list-of-cves---beautiful-soup">Map CVE to CVRF ID</a> - Translate the CVE to their corresponding CVRF IDs<li><a href="#parsing-out-the-data">Parse Data</a> - Parse out relevant data for the use case<li><a href="#transform-into-markdown">Transform Into Markdown</a> - Transform the data into valid markdown</ul><h3 id="getting-a-list-of-cves---beautiful-soup"><span class="mr-2">Getting a list of CVEs - Beautiful Soup</span><a href="#getting-a-list-of-cves---beautiful-soup" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>To get a list of CVEs I began with <a href="https://cve.mitre.org">cve.mitre.org</a>. They provide a search page that allows for <a href="https://cve.mitre.org/cve/search_cve_list.html">keyword search</a>. The results for the keyword search is unfortunately just a basic HTML table (think <code class="language-plaintext highlighter-rouge">&lt;td&gt;,&lt;tr&gt;, and &lt;th&gt;</code>) and not easy to consume data like JSON. Apparently, they are <a href="https://www.cve.org/Media/News/item/news/2022/01/11/Changes-Coming-to-CVE-Record#:~:text=The%20main%20format%20for%20submission%20and%20publishing%20of%20CVE%20Records%2C%20CVE%20JSON%204.0%2C%20is%20being%20upgraded%20to%20a%20new%2C%20richer%20format%3A%20JSON%205.0.">working on it</a>. To mitigate this, I used a <a href="https://github.com/clearbluejar/cve-markdown-charts/blob/v0.1.0/cve_markdown_charts.py#L20">beautiful library</a> to scrape the data needed from the Mitre CVE search results and built out my own JSON structure from it.</p><p>I could <a href="https://github.com/clearbluejar/cve-markdown-charts/blob/v0.1.0/cve_markdown_charts.py#L26">transform</a> the keyword search “Windows Print Spooler” into the following JSON.</p><div class="language-json highlighter-rouge"><div class="code-header"> <span data-label-text="JSON"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre><td class="rouge-code"><pre><span class="err">'</span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CVE-2022-23284"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Windows Print Spooler Elevation of Privilege Vulnerability.  "</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CVE-2022-22718"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Windows Print Spooler Elevation of Privilege Vulnerability. This CVE ID is unique from CVE-2022-21997, CVE-2022-21999, CVE-2022-22717.  "</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CVE-2022-22717"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Windows Print Spooler Elevation of Privilege Vulnerability. This CVE ID is unique from CVE-2022-21997, CVE-2022-21999, CVE-2022-22718.  "</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CVE-2022-21999"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Windows Print Spooler Elevation of Privilege Vulnerability. This CVE ID is unique from CVE-2022-21997, CVE-2022-22717, CVE-2022-22718.  "</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CVE-2022-21997"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Windows Print Spooler Elevation of Privilege Vulnerability. This CVE ID is unique from CVE-2022-21999, CVE-2022-22717, CVE-2022-22718.  "</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CVE-2021-41333"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Windows Print Spooler Elevation of Privilege Vulnerability  "</span><span class="w">
    </span><span class="p">},</span><span class="w">

 </span><span class="err">&lt;</span><span class="w"> </span><span class="err">several</span><span class="w"> </span><span class="err">lines</span><span class="w"> </span><span class="err">omitted</span><span class="w"> </span><span class="err">&gt;</span><span class="w">
</span></pre></table></code></div></div><h3 id="from-cve-to-cvrf-id"><span class="mr-2">From CVE to CVRF ID</span><a href="#from-cve-to-cvrf-id" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>The next step was to map the CVE to a CVRF ID. As explained <a href="#msrc-api">above</a>, MSRC provides the API.</p><blockquote><p>https://api.msrc.microsoft.com/cvrf/v2.0/Updates(‘CVE-2020-1048’)</p></blockquote><p>For each CVE, we could <a href="https://github.com/clearbluejar/cve-markdown-charts/blob/v0.1.0/cve_markdown_charts.py#L40">ask</a> the MSRC API to get the CVRF-ID:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">get_cvrf_id_and_date_for_cve</span><span class="p">(</span><span class="n">cve</span><span class="p">):</span>
    <span class="n">cvrf_id</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">releaseDate</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="n">year</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">cve</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">'-'</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
    <span class="c1"># MSRC CVRF is not available before 2016
</span>    <span class="k">if</span> <span class="n">year</span> <span class="o">&gt;</span> <span class="mi">2015</span><span class="p">:</span>
        <span class="n">url</span> <span class="o">=</span> <span class="s">"{}Updates('{}')?api-version={}"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">msrc_api_url</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">cve</span><span class="p">),</span>   <span class="nb">str</span><span class="p">(</span><span class="n">datetime</span><span class="p">.</span><span class="n">datetime</span><span class="p">.</span><span class="n">now</span><span class="p">().</span><span class="n">year</span><span class="p">))</span>
        <span class="n">headers</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">response</span><span class="p">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="n">loads</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">content</span><span class="p">)</span>
            <span class="n">cvrf_id</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s">"value"</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s">"ID"</span><span class="p">]</span>
            <span class="n">releaseDate</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s">"value"</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s">"InitialReleaseDate"</span><span class="p">]</span>
            <span class="n">cvrf_url</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s">"value"</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s">"CvrfUrl"</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">pass</span>

    <span class="k">return</span> <span class="n">cvrf_id</span><span class="p">,</span><span class="n">releaseDate</span>
</pre></table></code></div></div><p><a href="https://github.com/clearbluejar/cve-markdown-charts/blob/v0.1.0/cve_markdown_charts.py#L31">This</a> would return the <code class="language-plaintext highlighter-rouge">cvrf-id</code> (something like ‘2020-Sep’) and a few more useful fields. With the <code class="language-plaintext highlighter-rouge">cvrf-id</code> we could then <a href="https://github.com/clearbluejar/cve-markdown-charts/blob/v0.1.0/cve_markdown_charts.py#L54">fetch</a> the JSON from MSRC. I perform some simple <a href="https://github.com/clearbluejar/cve-markdown-charts/blob/v0.1.0/cve_markdown_charts.py#L63">caching</a> so that we don’t hammer the MSRC API with requests.</p><h3 id="parsing-out-the-data"><span class="mr-2">Parsing out the data</span><a href="#parsing-out-the-data" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>The following table provides a high level look at data, where it’s from, and where it’s used.</p><div class="table-wrapper"><table><thead><tr><th>API Endpoints<th>Format<th>Data<th>Used By<tbody><tr><td>cve.mitre.org<td>html<td><code class="language-plaintext highlighter-rouge">id</code>,<code class="language-plaintext highlighter-rouge">description</code><td><a href="https://github.com/clearbluejar/cve-markdown-charts/blob/v0.1.0/cve_markdown_charts.py#L15">get_json_cve_list_from_keyword</a><tr><td>api.msrc.microsoft.com/cvrf/v2.0/Updates<td>json<td><code class="language-plaintext highlighter-rouge">id</code>,<code class="language-plaintext highlighter-rouge">cvrf-id</code>,<code class="language-plaintext highlighter-rouge">release-date</code><td><a href="https://github.com/clearbluejar/cve-markdown-charts/blob/v0.1.0/cve_markdown_charts.py#L77">build_markdown_table_from_cves</a><br /><a href="https://github.com/clearbluejar/cve-markdown-charts/blob/v0.1.0/cve_markdown_charts.py#L115">build_markdown_gantt_from_cves</a><tr><td>api.msrc.microsoft.com/cvrf/v2.0/cvrf/<cvrf-id></cvrf-id><td>json<td><code class="language-plaintext highlighter-rouge">release_date</code>,<code class="language-plaintext highlighter-rouge">kbs</code>,<code class="language-plaintext highlighter-rouge">acks</code><td><a href="https://github.com/clearbluejar/cve-markdown-charts/blob/v0.1.0/cve_markdown_charts.py#L77">build_markdown_table_from_cves</a></table></div><p>For the Markdown table, I <a href="https://github.com/clearbluejar/cve-markdown-charts/blob/v0.1.0/cve_markdown_charts.py#L91-L95">select</a> information available from the MSRC CVRF JSON.</p><p>For the Gannt Chart, you can glean all the needed the information from the <a href="#updates-endpoint">updates</a> endpoint.</p><h3 id="transform-into-markdown"><span class="mr-2">Transform into Markdown</span><a href="#transform-into-markdown" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><h4 id="building-the-markdown-cve-table"><span class="mr-2">Building the Markdown CVE Table</span><a href="#building-the-markdown-cve-table" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>The CVE Markdown table generation in <a href="https://github.com/clearbluejar/cve-markdown-charts/blob/v0.1.0/cve_markdown_charts.py#L77">build_markdown_table_from_cves</a> uses the following headers.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">build_markdown_table_from_cves</span><span class="p">(</span><span class="n">cves</span><span class="p">,</span><span class="n">keyword</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"Building table..."</span><span class="p">)</span>

    <span class="n">table_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">table_list</span><span class="p">.</span><span class="n">extend</span><span class="p">([</span><span class="s">'CVE'</span><span class="p">,</span><span class="s">'Description'</span><span class="p">,</span> <span class="s">'Release Date'</span><span class="p">,</span> <span class="s">'KBs'</span><span class="p">,</span> <span class="s">'Acknowledgments'</span><span class="p">])</span>
</pre></table></code></div></div><p>I found a <a href="https://pypi.org/project/mdutils/">basic</a> Markdown generation library <code class="language-plaintext highlighter-rouge">mdutils</code> to help build markdown files. The data for each CVE comes from the MSRC CVRF JSON. The data is <a href="https://github.com/clearbluejar/cve-markdown-charts/blob/v0.1.0/cve_markdown_charts.py#L85-L105">parsed</a> and then dumped into a Markdown table constructor.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre><span class="k">for</span> <span class="n">cve</span> <span class="ow">in</span> <span class="n">cves</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="n">cve</span><span class="p">[</span><span class="s">'id'</span><span class="p">])</span>
        <span class="n">cvrf_id</span><span class="p">,</span><span class="n">release_date</span> <span class="o">=</span> <span class="n">get_cvrf_id_and_date_for_cve</span><span class="p">(</span><span class="n">cve</span><span class="p">[</span><span class="s">'id'</span><span class="p">])</span>
        <span class="n">cvrf_json</span> <span class="o">=</span> <span class="n">get_knowledge_base_cvrf_json</span><span class="p">(</span><span class="n">cvrf_id</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">cvrf_json</span><span class="p">:</span>
            <span class="n">release_date</span> <span class="o">=</span> <span class="s">'[{}](https://msrc.microsoft.com/update-guide/en-US/vulnerability/{})'</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">release_date</span><span class="p">,</span><span class="n">cve</span><span class="p">[</span><span class="s">'id'</span><span class="p">])</span>
            <span class="n">kbs</span> <span class="o">=</span> <span class="p">{</span><span class="s">'[KB{}]({})-{}'</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">kb</span><span class="p">[</span><span class="s">'Description'</span><span class="p">][</span><span class="s">'Value'</span><span class="p">],</span><span class="n">kb</span><span class="p">[</span><span class="s">'URL'</span><span class="p">],</span><span class="n">kb</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">'FixedBuild'</span><span class="p">))</span> <span class="k">for</span> <span class="n">vuln</span> <span class="ow">in</span> <span class="n">cvrf_json</span><span class="p">[</span><span class="s">"Vulnerability"</span><span class="p">]</span> <span class="k">if</span> <span class="n">vuln</span><span class="p">[</span><span class="s">"CVE"</span><span class="p">]</span> <span class="o">==</span> <span class="n">cve</span><span class="p">[</span><span class="s">'id'</span><span class="p">]</span> <span class="k">for</span> <span class="n">kb</span> <span class="ow">in</span> <span class="n">vuln</span><span class="p">[</span><span class="s">"Remediations"</span><span class="p">]</span> <span class="k">if</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">kb</span><span class="p">[</span><span class="s">'Description'</span><span class="p">][</span><span class="s">'Value'</span><span class="p">]).</span><span class="n">isnumeric</span><span class="p">()</span> <span class="ow">and</span> <span class="s">'FixedBuild'</span> <span class="ow">in</span> <span class="n">kb</span><span class="p">)</span>  <span class="p">}</span>
            <span class="n">kbs</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">([</span><span class="s">'[{}]({}) - [KB{}]({})'</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">kb</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">'FixedBuild'</span><span class="p">),</span><span class="s">'https://support.microsoft.com/help/{}'</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">kb</span><span class="p">[</span><span class="s">'Description'</span><span class="p">][</span><span class="s">'Value'</span><span class="p">]),</span><span class="n">kb</span><span class="p">[</span><span class="s">'Description'</span><span class="p">][</span><span class="s">'Value'</span><span class="p">],</span><span class="n">kb</span><span class="p">[</span><span class="s">'URL'</span><span class="p">])</span> <span class="k">for</span> <span class="n">vuln</span> <span class="ow">in</span> <span class="n">cvrf_json</span><span class="p">[</span><span class="s">"Vulnerability"</span><span class="p">]</span> <span class="k">if</span> <span class="n">vuln</span><span class="p">[</span><span class="s">"CVE"</span><span class="p">]</span> <span class="o">==</span> <span class="n">cve</span><span class="p">[</span><span class="s">'id'</span><span class="p">]</span> <span class="k">for</span> <span class="n">kb</span> <span class="ow">in</span> <span class="n">vuln</span><span class="p">[</span><span class="s">"Remediations"</span><span class="p">]</span> <span class="k">if</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">kb</span><span class="p">[</span><span class="s">'Description'</span><span class="p">][</span><span class="s">'Value'</span><span class="p">]).</span><span class="n">isnumeric</span><span class="p">()</span> <span class="ow">and</span> <span class="s">'catalog'</span> <span class="ow">in</span> <span class="n">kb</span><span class="p">[</span><span class="s">'URL'</span><span class="p">]</span> <span class="p">)])</span>
            <span class="n">acks</span> <span class="o">=</span> <span class="p">{</span><span class="s">'{}'</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">ack</span><span class="p">[</span><span class="s">'Name'</span><span class="p">][</span><span class="mi">0</span><span class="p">].</span><span class="n">get</span><span class="p">(</span><span class="s">'Value'</span><span class="p">))</span> <span class="k">for</span> <span class="n">vuln</span> <span class="ow">in</span> <span class="n">cvrf_json</span><span class="p">[</span><span class="s">"Vulnerability"</span><span class="p">]</span> <span class="k">if</span> <span class="n">vuln</span><span class="p">[</span><span class="s">"CVE"</span><span class="p">]</span> <span class="o">==</span> <span class="n">cve</span><span class="p">[</span><span class="s">'id'</span><span class="p">]</span> <span class="k">for</span> <span class="n">ack</span> <span class="ow">in</span> <span class="n">vuln</span><span class="p">[</span><span class="s">"Acknowledgments"</span><span class="p">]</span> <span class="p">}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">kbs</span> <span class="o">=</span> <span class="s">''</span>
            <span class="n">builds</span> <span class="o">=</span> <span class="s">''</span>
            <span class="n">acks</span> <span class="o">=</span> <span class="s">''</span>
                
        <span class="n">cve_id</span> <span class="o">=</span> <span class="s">'[{}](https://cve.mitre.org/cgi-bin/cvename.cgi?name={})'</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">cve</span><span class="p">[</span><span class="s">'id'</span><span class="p">],</span><span class="n">cve</span><span class="p">[</span><span class="s">'id'</span><span class="p">])</span>

        <span class="n">table_list</span><span class="p">.</span><span class="n">extend</span><span class="p">([</span><span class="n">cve_id</span><span class="p">,</span><span class="n">cve</span><span class="p">[</span><span class="s">'description'</span><span class="p">],</span><span class="n">release_date</span><span class="p">,</span><span class="s">'&lt;details&gt;'</span><span class="o">+</span><span class="s">'&lt;br&gt;'</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">kbs</span><span class="p">)</span><span class="o">+</span><span class="s">'&lt;/details&gt;'</span><span class="p">,</span> <span class="s">'&lt;br&gt;'</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">acks</span><span class="p">).</span><span class="n">replace</span><span class="p">(</span><span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">,</span><span class="s">' '</span><span class="p">)])</span>
        
    <span class="n">cve_table</span> <span class="o">=</span> <span class="n">Table</span><span class="p">().</span><span class="n">create_table</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">column_len</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">cves</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">table_list</span><span class="p">,</span> <span class="n">text_align</span><span class="o">=</span><span class="s">'center'</span><span class="p">)</span>
</pre></table></code></div></div><h4 id="building-the-gantt-mermaidjs-chart"><span class="mr-2">Building the Gantt Mermaid.js Chart</span><a href="#building-the-gantt-mermaidjs-chart" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>The Gantt chart is generation is simply filling a Mermiad.js Gantt chart <a href="https://github.com/clearbluejar/cve-markdown-charts/blob/v0.1.0/cve_markdown_charts.py#L116">template</a> with CVE data.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>    <span class="n">gantt_template</span> <span class="o">=</span> <span class="s">'''
gantt

title {keyword}
dateFormat YYYY-MM-DD
axisFormat %Y-%m

section CVE Release Dates
{rows}
'''</span>
</pre></table></code></div></div><p>The rows are <a href="https://github.com/clearbluejar/cve-markdown-charts/blob/v0.1.0/cve_markdown_charts.py#L136-L149">built</a> up from the <code class="language-plaintext highlighter-rouge">api.msrc.microsoft.com/cvrf/v2.0/Updates</code> endpoint that provides both <code class="language-plaintext highlighter-rouge">cvrf-id</code> and CVE <code class="language-plaintext highlighter-rouge">release-date</code>.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="k">for</span> <span class="n">num</span><span class="p">,</span><span class="n">cve</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">cves</span><span class="p">):</span>
        <span class="n">cvrf_id</span><span class="p">,</span><span class="n">release_date</span> <span class="o">=</span> <span class="n">get_cvrf_id_and_date_for_cve</span><span class="p">(</span><span class="n">cve</span><span class="p">[</span><span class="s">'id'</span><span class="p">])</span>
        
        <span class="c1">#handle release dates
</span>        <span class="k">if</span> <span class="n">release_date</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">year</span> <span class="o">=</span> <span class="n">cve</span><span class="p">[</span><span class="s">'id'</span><span class="p">].</span><span class="n">split</span><span class="p">(</span><span class="s">'-'</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">release_date</span> <span class="o">=</span> <span class="s">'{}-01-01'</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">cve</span><span class="p">[</span><span class="s">'id'</span><span class="p">].</span><span class="n">split</span><span class="p">(</span><span class="s">'-'</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">cvrf_id</span> <span class="o">=</span> <span class="n">year</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
            <span class="n">release_date</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">release_date</span><span class="p">,</span><span class="s">'%Y-%m-%dT%H:%M:%SZ'</span><span class="p">).</span><span class="n">strftime</span><span class="p">(</span><span class="s">"%Y-%m-%d"</span><span class="p">)</span>

        <span class="n">row</span> <span class="o">=</span> <span class="s">'{} :cve{}, {}, 30d'</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">cve</span><span class="p">[</span><span class="s">'id'</span><span class="p">],</span><span class="n">num</span><span class="p">,</span><span class="n">release_date</span><span class="p">)</span>
        <span class="n">sections</span><span class="p">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">cvrf_id</span><span class="p">,[]).</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
</pre></table></code></div></div><h2 id="working-poc"><span class="mr-2">Working POC</span><a href="#working-poc" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>And finally, with the Python script a bit over explained, here is the result.</p><h3 id="usage"><span class="mr-2">Usage</span><a href="#usage" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>% python cve_markdown_charts.py <span class="nt">-h</span>    
usage: cve_markdown_charts.py <span class="o">[</span><span class="nt">-h</span><span class="o">]</span> keyword <span class="o">[</span>keyword ...]

Generate CVE Markdown Charts

positional arguments:
  keyword     The CVE keyword to chart

optional arguments:
  <span class="nt">-h</span>, <span class="nt">--help</span>  show this <span class="nb">help </span>message and <span class="nb">exit</span>
</pre></table></code></div></div><p>For some light scripting work, the results are pretty good.</p><h3 id="windows-print-spooler-charts"><span class="mr-2">Windows Print Spooler Charts</span><a href="#windows-print-spooler-charts" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>python cve_markdown_charts.py Windows Print Spooler 
</pre></table></code></div></div><p>Generates the files:</p><ul><li><a href="https://gist.github.com/clearbluejar/211876b8cd4e3d146bbc74fdd5bca8bb#file-windows-print-spooler-gannt-md">Windows-print-spooler-gantt.md</a><li><a href="https://gist.github.com/clearbluejar/211876b8cd4e3d146bbc74fdd5bca8bb#file-windows-print-spooler-table-md">Windows-print-spooler-table.md</a></ul><h4 id="gantt"><span class="mr-2">Gantt</span><a href="#gantt" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><pre><code class="language-mermaid">gantt

title Windows Print Spooler
dateFormat YYYY-MM-DD
axisFormat %Y-%m

section CVE Release Dates
section 2022-Mar
CVE-2022-23284 :cve0, 2022-03-08, 30d
section 2022-Feb
CVE-2022-22718 :cve1, 2022-02-08, 30d
CVE-2022-22717 :cve2, 2022-02-08, 30d
CVE-2022-21999 :cve3, 2022-02-08, 30d
CVE-2022-21997 :cve4, 2022-02-08, 30d
section 2021-Dec
CVE-2021-41333 :cve5, 2021-12-14, 30d
section 2021-Oct
CVE-2021-41332 :cve6, 2021-10-12, 30d
CVE-2021-36970 :cve10, 2021-10-12, 30d
section 2021-Sep
CVE-2021-40447 :cve7, 2021-09-14, 30d
CVE-2021-38671 :cve8, 2021-09-14, 30d
CVE-2021-38667 :cve9, 2021-09-14, 30d
section 2021-Aug
CVE-2021-36958 :cve11, 2021-08-10, 30d
CVE-2021-36947 :cve12, 2021-08-10, 30d
CVE-2021-36936 :cve13, 2021-08-10, 30d
CVE-2021-34483 :cve15, 2021-08-10, 30d
section 2021-Jul
CVE-2021-34527 :cve14, 2021-07-13, 30d
CVE-2021-34481 :cve16, 2021-07-13, 30d
section 2021-Jun
CVE-2021-1675 :cve19, 2021-06-08, 30d
section 2021-Mar
CVE-2021-26878 :cve17, 2021-03-09, 30d
CVE-2021-1640 :cve20, 2021-03-09, 30d
section 2021-Jan
CVE-2021-1695 :cve18, 2021-01-12, 30d
section 2020-Nov
CVE-2020-17042 :cve21, 2020-11-10, 30d
CVE-2020-17014 :cve22, 2020-11-10, 30d
CVE-2020-17001 :cve23, 2020-11-10, 30d
section 2020-Sep
CVE-2020-1030 :cve27, 2020-09-08, 30d
section 2020-Aug
CVE-2020-1337 :cve24, 2020-08-11, 30d
section 2020-May
CVE-2020-1070 :cve25, 2020-05-12, 30d
CVE-2020-1048 :cve26, 2020-05-12, 30d
section 2019-Mar
CVE-2019-0759 :cve28, 2019-03-12, 30d
section 2016-Jul
CVE-2016-3239 :cve29, 2016-07-12, 30d
CVE-2016-3238 :cve30, 2016-07-12, 30d
section 2013
CVE-2013-1339 :cve31, 2013-01-01, 30d
CVE-2013-0011 :cve32, 2013-01-01, 30d
section 2012
CVE-2012-1851 :cve33, 2012-01-01, 30d
section 2010
CVE-2010-2729 :cve34, 2010-01-01, 30d
section 2009
CVE-2009-0230 :cve35, 2009-01-01, 30d
CVE-2009-0229 :cve36, 2009-01-01, 30d
CVE-2009-0228 :cve37, 2009-01-01, 30d
section 2006
CVE-2006-6296 :cve38, 2006-01-01, 30d
section 2005
CVE-2005-1984 :cve39, 2005-01-01, 30d
section 2001
CVE-2001-1451 :cve40, 2001-01-01, 30d
section 1999
CVE-1999-0899 :cve41, 1999-01-01, 30d
CVE-1999-0898 :cve42, 1999-01-01, 30d

</code></pre><h3 id="google-chrome-uaf"><span class="mr-2">Google Chrome UAF</span><a href="#google-chrome-uaf" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>python cve_markdown_charts.py Google Chrome Use After Free
</pre></table></code></div></div><p>Generates the files:</p><ul><li><a href="https://gist.github.com/clearbluejar/211876b8cd4e3d146bbc74fdd5bca8bb#file-google-chrome-use-after-free-gannt-md">Google-Chrome-Use-After-Free-gantt.md</a><li><a href="https://gist.github.com/clearbluejar/211876b8cd4e3d146bbc74fdd5bca8bb#file-google-chrome-use-after-free-table-md">Google-Chrome-Use-After-Free-table.md</a></ul><p>Sometimes the CVE keyword is too broad. For the keyword “Google Chrome Use After Free” the script still works, it just takes a bit of time. It generates a chart with <strong>600+ CVE results</strong>! Perhaps we need some filters on date range or number of results. If you want to see the full results of the output, try it yourself or view the gist <a href="https://gist.github.com/clearbluejar/211876b8cd4e3d146bbc74fdd5bca8bb#file-google-chrome-use-after-free-gannt-md">here</a>.</p><p>Another fun thing to do is use the Mermaid.Js <a href="https://mermaid.live/">live editor</a>. It can help generate images if you need them or see what different <a href="https://mermaid-js.github.io/mermaid/#/theming?id=theme-configuration">themes</a> might look like. You can click this <a href="https://mermaid.live/edit#pako:eNqFne-LHbcVhv-VZSHffEHS0U9_C3FSCKSFhhYC-2Vr3zim9m5Yb0JDyP_eu6v3Hd9rj85bCk2dZ0bSeTSSjmau_Of16_s3x-uX129v7x4fb-5u7h7fPb4_Xv3t_v7t6X---eXh_sPx6l8fj1df__x4fLj67uF4vLl7c_t4_O7-4cPt49VPp_8cfvjh8OrVzd3t_959xB9_9dPhqw9Pt_t4fP347v7u6pt_f3v1z-P74-3pVq9Ol3_89K9SSOnw_e0JPkGH5_8XLPSrl69_P4YX81-HeIjxxZWFN5dUe6aioPIzlQSVnikTVHimskulMWtfBDVrXwVVn6kmqPJMdUHZMzUENdsY_eCnPibmRz_SURLYbGY0gc12xiyw2dDoGwgDTagCmzpjExiasCfhrLPHw6vj6-3CeMgRXS9OL6er0uGpgef3P2GsbQo-VmfAUxTYjGRKAsPDYwKbAU_ZxwrqVgSGu1WBzbiltoNdBPzv97-fXWg9xDiv7LwyHsL4vIATh2EoDcVN9RYUN4NucYe7qPE_Xj9-diWGp01XODw9Up-V0Ab6qpnipgnLipsqrAiuo9yqOJTbFIdIdcWhfkNxM345CK7N-uWouFm_rHy0-fzkPR8Xxn88_vrZlbNlmYbC2HkInjhMSUVwFRGoipvPRm6CK3M4yl1xiOhQ3HyGSnC500gz41Ki4NKsX0mKmyaL7XAXhr7-7e3llVhYlM1QPzxNml-UgGe3FMXNyJfqcwXPbumKQ_2G4ma5Nexw5xH4rLaz35Wtnzz9d-fuefrqRXEzSr16XIrRMBtvg_cKjFgrbGPcEswAiwIxUZuqY8QSypoAA1YgphqDmShuA90SxHprG-mWIJYr21B3Dl50_O9_e3-pqs9L63ZlOzwt3L5QikG8JsWhA5rg2oxWzYpD_YripvhaFTe7cG2Km_2jdsFVtGMobrpsQXGz3KZ81Nktm_KRp4--197Pesbd5ZUY7Ntmsp5Gk50SMNi3rLjZg1pR3DTZquKmydYUh4h2xSGiQ3B5Gu9BcfMx71FxM349KQ55ofKRZ_z6no8L4z_c_nF5paGELVLli-TomcN03IfiZgRGUNzsaSMqbtZvJMXNCAxTHHLorLjZg0ZR3OxBowouzviNpji0V_nApDeUD855QQnhnBf2jFwupH59uJiKkrGMTVLeGZhOYMKcFUyAnNJDViB2CkIRIOfVUBXIOjYFso5dgazjUCDiGIMCI8Dog5E7JDEpEIutaApEq-Oemc-GmofPLkUc4ubKdtLsJ5DNqwJE1hpjUyA6d-wCbAzYEGDlvlhQIKRuGzrn4EXAvjv-5_LSwjI2e2m_jIKAbds8SxBx2DZ6ViAmqLht9SxBdJxts2cJMg5tB7xcldzeXV6KsT2ms8Xzl9n6E8gFflAgAmZRgcwEkgAjMwFbg-EQT0knGjPqDngWh3B22WDWHLFhEfbSgnCoXDpHbFisOd4vCw4RxfbEksNuQsT2xJpD67E9seZYvy441m8IDsKxPbHm4BvbE0sOC8JYhA8-HkX4YK8owkfmzrjwwaetCB-ZcRE-jO0VPrgUKMJHxMhdhQ9uAlThg4l4FT74AqL6PjJfBtQsOPioRXCIS_V9ZKS0sfo-Mqef2gXHdgzBIS4tCA7tbVFwaG9LgkP_a8IHx5cmfHDKbMIHx6EmfHDcaMIHx40mfHDcaMIHEsnYhQ_jSyvhw9DeLnwgzYtd-Eisn_CBNC924YNTfBc-kL7FLnxwJdCFD672u-_DsGUWRxAcZ3ffh3GdOZLgEOdhgkOch-vjafmBB30UAXLEH02BrGJXIOs4BIg0MYWgQLxoDFGAmG5SSArEG85gCsSL1aACzs8Xggp4YGOqAvHeNCgzSBNT8M0UvnVMYSiQL6eDAqEwRgUiPDEpEOGJpkC0OmYFBoBFgJ2trgJsbHVTIBRGZaaxMcoMXiOmpMxg8zolZaaiUyRlhl8spD0znzKaOHhZHIfSG2__rOn0R1_efnKI6cxEHQ4hnYmowzFQzee2OHXBsR1DcCh35qZrDiuONFNTh-P9ks8hE0gzMV1zHHRN-MCOWzLhAyvyZMIHv9Ew4QMr92S-j9ZZ7hAcys2uj2iN3TtHBSKCOSkQTckmQGRTKWcBYtmWclEgi64K5BdBTYHor7krEB02Dx-s_FCqBAUi4CUqEK0uSYGYjYopEOEpwkxlNytFgfy2qiqQrW4KZKv3zJyNy327rB9q5IwzM_jTH-3c_onDyj7NDN7h-DFY9Dku0WYGv-QC4zQzeIdDmGYGv-Y4b8wMfs1x_J4Z_JpDZplmBr_mDHGeGfyKOyVihQ0ZAsTeUGpBgFiIp-YqOeXa2I1ILQmQHwY2V8ppSco-2bIA2Q1bESCH51YViDi2pkDWcc_M2XPTtsvaoUQOwTOzP_3Rzu2fOdR3ZvYOh-rOzH7Nbd9CJp_D9z5pZvZLjl_LppnZOxzLLT7H53Vm9g7H-jWfY5-cmb3D4Wnovo-Anao0fB-h8FvSKDh4G0lw6GVD-OBTPYQP5OtpCB_GdggfxnYIH9hZSkP44Hg3hA-sJywIH3jhYsH1EUvGG3ALSYEs2RQYAGYftME6FgXic9mwJ-VsyKnbZfVQ0haCqaju3f6Z4-fNXXCsxRAcPtqduwAOh4DOTYA1F3i_5HKRHwvPLYA1h80wmzsADsf6FcHB98z_1xwefYtNcCy3C47l-j74atWS74OfXlqKgkM7kvCBR9qS8IEpz5Lr4xRm1q8IjuVWwSF-yfUR6yDXfa6TGz6HzV2z4HN4mWIWBQe_lnwOU4qZ-Vzmjwyy4ODNiuAyuCo4eDPhwxg_4cPYXuEDU5Rl4QMv2S0LHxz_susj8BN7y3s-zkb1sl1VDj2z9yDpL3t3L4fKjQ5Dzr_m0GuR8i85jprI-Ncco9l9rvJ-Q3AYbZDurznYRra_5JCLGJL9NcdyzeX4dbMV18dp_Q8fpQiO7aiCQ5xL87lOrgsOo0gZPsd-UIPgEL8aBYdya_I5JNhWzeforQofHA2r8MHZuAofmfcTPrBgtyp8cJSrwofxJ1fCBzZarAkfeDVqTfjgQrwJH9jXsyZ8YIPHmvDB1WoTPrDBbE34CIzfno-zUThvV-XD2OY-pPN57-750AbtIJ1fc2gV0vk1xx_OJcHhqUc6v-bQK5DOrzn0CqTzaw62kc4vOWyHGNL5Ncf2dsGxvcIHbQ_hgz_5HMIHf7g5hA-uNYfrw_j9rI0sOP4wsgiO9auCw9M8muDYju5zeH1nYwgOP0cMwefwui2HKLgOLgkOP_AMwge2a3NwfTxtcYIrgsPPPkMVHH_Q2gSHn4eG7nPG-w2fS_yBbBAc4hKj4FBuTIJDO6L5HPY0chQ-sAbPUfgI5ISPwHYIHzxBIu75OJtNbLvKDrVWRnPasb27P3OoLTL5JYfNyIxMfs3xZ85JcCzXfA6fr2Vk8msOvQyZ_Jqr4Krg2I4mOIw2yOSXnPF-wgd2OLIJH5jFsgkffKpM-OBTZcJHYv1cH2nwqbciOPiwKji2twmO7e2CY3uH4NDeHHwOa82co-BQv5wExx_zm-DQjix8RLZD-MBOc87CB9bCOQsfge0VPjhqZuGDo2bxfXS89sslCg71K0lwqF_xfXQewlCy4OCjFMHxsAbfR-d4X5rgWG4XHMv1fXTOC1X44KEOVfhArp2r8MHxvgofHO-r8IEdxVyFD662qvDB1VYVPjh_VOGDq7IqfCA7zE34QJaWm-sjDK6iWvI5rqKaCQ4-WvY5fHyVWxEc21EFBx_N9RE6Xkbn1n2uMy7D54yHngTBoX59z8fZKi9tV6VP738ycve0d_f06b1ORu6-5PhUIXdfc7CD3H3Nsdzqc1uUmuBYvy441m8IDr0HufuS4yoFufuaQ7lD-OCqYggffFqG8MFVwHB9pD7Y3io4eBvN5_CtWR5dcDzSZwgOR-uE4HPYCygh-hzeY5WQfA6zUwkmONYvC47lCh-YTUoQPjLvJ3wgeyhB-OBRR0H4wCq-ROEDq-4ShY_Eo5iED6ymSxQ-Iuvn-ogd41WJro9Y8FyWuOfjbBTeTjaK8WD8ZL4gk987QeeZw45TQSa_5tj6ITgcgIXcfcmxdyN3X3L4iVVB7r7mEE3k7msOvQK5-5pD_JC7LznkRAW5-5rD05KEDx7HlXwfncdnpSE4lGtBcDgIy3wfHF2LJcHxQDITHOJnWXBsh--Ds04x3wePoirWBMd2-D54rmWxITg8HzkIDv0v-z4C3n-XnATHck1wLNf3ETjb5SI49NNcBcf6NcHBRxY-Go-1Ez6QG5cifHA8LcIHcuNShA-Ou0X44LhbhA_k2qUIH4XtFT4K2yt8FLZX-Misn_DB1UcVPrj6qMJH5nGEwgdW-6UKH_h6rFThA6v9UoUPvMEsVfgwtlf44GqrCh9c9VThg_NgEz646mnCB7KH0lwfiblsaeZzHDda9rnK-xWf47qkVcHBW2uCQ5xb97nMcofg0N4efI79qkef42q6Cx9cX3Xhg-urLnyw_3Xhg_2vCx9cnXfhg8eTdt9H43zeh-AQvxEEB28jCg5xGUlwGA-GCQ79fvg--B1dGb4PY38eVXCI8_B9WGa5XXCMn-_DMO7WEASHUzOD6yOyX9WQBIfTOoP5HN5R1JAFx3JdH5H9qgbXR-RRHzU0n8usXxdcAOf6iIbnrUbXR-Sp_jVGweF00uj74FFuNZrgWD_fB0_fqtH3EfC1a42-D65fqp-fBx75Xf38PPC71ern5yE3nma75-NsN2E7eCuGw6lToPXI1vd-BT85WES2vubQKmTrS45n9CJbX3E8CrAiW19xkX9bBbL1BWepkGuCYzu6y3HPtCJbX3CJf39HRba-5vD0mesjctaulgQHv2aCg19zfcTGM4TN9RH4ZUa1PR-femPYDk14Otecv1SoM3cPlz_pvX5x_eH48OH23Zvrl9d_3txdXd1cP_5y_HC8uX55-sc3tw__vbm-ufvrxP3269NfAvPtm3eP9w_XL3--ff_x-OL69rfH-x__uHu9_cGkXr27fftw-wF_-tf_AY0regQ">link</a> that somehow contains all the info (the 600 CVE references) you need.</p><p><img data-src="/assets/img/2022-03-19-introducing-cve-markdown-charts-part-1/mermaid-live-google-chrome-uaf.png" alt="mermaid-live-google-chrome-uaf" class="shadow" data-proofer-ignore><em>Mermaid.JS Live Editor with 600 Google Chrome UAF refs</em></p><h2 id="done-not-done"><span class="mr-2">Done? Not Done</span><a href="#done-not-done" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Like many developers (and even those that pretend to be), I began with this intention:</p><pre><code class="language-mermaid">graph LR;

A[Problem] --&gt; B[Automation Idea] --&gt; C[Develop Quick Script] --&gt; D[Problem Solved]

</code></pre><p>But ended with this situation:</p><pre><code class="language-mermaid">
graph LR;

A[Problem] --&gt; B[Idea] --&gt; C[Develop] --&gt; C1[Progressively Complex Solution];
C1 --&gt; D[New Feature Idea] --&gt; C;
D -.-&gt; E[Done]

</code></pre><p>The most elusive part of any software project is getting to that last step. <strong>Done</strong>. This project is no different. Like most software projects, I started with a problem and came up with a quick solution that got me most of the way there (the 80% solution). My hope of being satisfied with a quick script faded as I thought about new use cases, new features, and converting this script into something much bigger. The typical issue of a working solution snowballing into several new ideas and features once again emerged.</p><p>Some thoughts for next steps include:</p><ul><li>Replace <a href="https://cve.mitre.org/">cve.mitre.org</a> web scraping with pure JSON from <a href="https://services.nvd.nist.gov/rest/json/cves/1.0/">services.nvd.nist.gov/rest/json/cves/1.0/</a><li>Support a list of CVEs as input<li>Add more charts<li>Scrap the python script entirely and build some sort of free CVE Markdown generator service</ul><p>Time and motivation will determine how quickly I accomplish these tasks, but it’s always fun to have the next project in mind. I hope I encouraged you to at least check out Mermaid.js for your next blog or research report. Until next time…</p><p>If you have thoughts, ideas, or corrections let me know <a href="https://twitter.com/clearbluejar">@clearbluejar</a> or create an <a href="https://github.com/clearbluejar/cve-markdown-charts/issues">issue</a>.</p><hr /><p><sub>Cover photo by RODNAE Productions from Pexels</sub></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/projects/'>projects</a>, <a href='/categories/cve-markdown-charts/'>cve-markdown-charts</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/cve/" class="post-tag no-text-decoration" >cve</a> <a href="/tags/mermaidjs/" class="post-tag no-text-decoration" >mermaidjs</a> <a href="/tags/markdown/" class="post-tag no-text-decoration" >markdown</a> <a href="/tags/charts/" class="post-tag no-text-decoration" >charts</a> <a href="/tags/graphs/" class="post-tag no-text-decoration" >graphs</a> <a href="/tags/msrc/" class="post-tag no-text-decoration" >msrc</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Introducing+CVE+Markdown+Charts+-+Part+1+-+clearbluejar&url=https%3A%2F%2Fclearbluejar.github.io%2Fposts%2Fintroducing-cve-markdown-charts-part-1%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Introducing+CVE+Markdown+Charts+-+Part+1+-+clearbluejar&u=https%3A%2F%2Fclearbluejar.github.io%2Fposts%2Fintroducing-cve-markdown-charts-part-1%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fclearbluejar.github.io%2Fposts%2Fintroducing-cve-markdown-charts-part-1%2F&text=Introducing+CVE+Markdown+Charts+-+Part+1+-+clearbluejar" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/from-ntobjectmanager-to-petitpotam/">From NtObjectManager to PetitPotam</a><li><a href="/posts/introducing-cve-markdown-charts-part-1/">Introducing CVE Markdown Charts - Part 1</a><li><a href="/posts/mining-google-chrome-cve-data/">Mining Google Chrome CVE data</a><li><a href="/posts/surveying-windows-rpc-discovery-tools/">A Survey of Windows RPC Discovery Tools</a><li><a href="/posts/these-are-your-first-steps/">These Are Your First Steps</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/cve/">cve</a> <a class="post-tag" href="/tags/graphs/">graphs</a> <a class="post-tag" href="/tags/ntlmrelay/">NTLMrelay</a> <a class="post-tag" href="/tags/ntobjectmanager/">ntobjectmanager</a> <a class="post-tag" href="/tags/rpc/">rpc</a> <a class="post-tag" href="/tags/rpcview/">rpcview</a> <a class="post-tag" href="/tags/blog/">blog</a> <a class="post-tag" href="/tags/c/">C#</a> <a class="post-tag" href="/tags/charts/">charts</a> <a class="post-tag" href="/tags/chrome/">chrome</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/mining-google-chrome-cve-data/"><div class="card-body"> <em class="small" data-ts="1652819880" data-df="ll" > May 17, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Mining Google Chrome CVE data</h3><div class="text-muted small"><p> TL;DR - The Google Chrome Releases blog provides CVE data one liners containing all the information needed to create a rich CVE data source. Google Chrome CVEs are plentiful and provide informat...</p></div></div></a></div><div class="card"> <a href="/posts/cve-north-stars/"><div class="card-body"> <em class="small" data-ts="1661856480" data-df="ll" > Aug 30, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Introducing CVE North Stars</h3><div class="text-muted small"><p> TL;DR - CVE North Stars is a tutorial that introduces a method to kickstart vulnerability research by treating CVEs as North Stars in vulnerability discovery and comprehension. Background Thi...</p></div></div></a></div><div class="card"> <a href="/posts/from-ntobjectmanager-to-petitpotam/"><div class="card-body"> <em class="small" data-ts="1656042360" data-df="ll" > Jun 24, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>From NtObjectManager to PetitPotam</h3><div class="text-muted small"><p> TL;DR - Windows RPC enumeration, discovery, and auditing via NtObjectManager. We will audit the vulnerable RPC interfaces that lead to PetitPotam, discover how they have changed over the past year,...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/these-are-your-first-steps/" class="btn btn-outline-primary" prompt="Older"><p>These Are Your First Steps</p></a> <a href="/posts/mining-google-chrome-cve-data/" class="btn btn-outline-primary" prompt="Newer"><p>Mining Google Chrome CVE data</p></a></div></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/clearbluejar">clearbluejar</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/cve/">cve</a> <a class="post-tag" href="/tags/graphs/">graphs</a> <a class="post-tag" href="/tags/ntlmrelay/">NTLMrelay</a> <a class="post-tag" href="/tags/ntobjectmanager/">ntobjectmanager</a> <a class="post-tag" href="/tags/rpc/">rpc</a> <a class="post-tag" href="/tags/rpcview/">rpcview</a> <a class="post-tag" href="/tags/blog/">blog</a> <a class="post-tag" href="/tags/c/">C#</a> <a class="post-tag" href="/tags/charts/">charts</a> <a class="post-tag" href="/tags/chrome/">chrome</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><script src="https://cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js"></script> <script> $(function() { function updateMermaid(event) { if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { const mode = event.data.message; if (typeof mermaid === "undefined") { return; } let expectedTheme = (mode === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* Re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } let initTheme = "default"; if ($("html[data-mode=dark]").length > 0 || ($("html[data-mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches ) ) { initTheme = "dark"; } let mermaidConf = { theme: initTheme /* <default|dark|forest|neutral> */ }; /* Markdown converts to HTML */ $("pre").has("code.language-mermaid").each(function() { let svgCode = $(this).children().html(); $(this).addClass("unloaded"); $(this).after(`<div class=\"mermaid\">${svgCode}</div>`); }); mermaid.initialize(mermaidConf); window.addEventListener("message", updateMermaid); /* fix mermaid failing to render without refresh */ const toggle = new ModeToggle(); toggle.notify(); /* end fix */ }); </script><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-QR0Y2106CS"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-QR0Y2106CS', {'cookie_expires': 0 }); }); </script>
